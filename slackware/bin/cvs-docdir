#!/bin/bash
# vi: et sts=4 sw=4 ts=4

DOCDIR_BASE='usr/doc'

# ensure non-translated messages
export LC_MESSAGES=C

cvs_rev() {
    local \
        DIR=${1:-$PWD}

    if [[ -d $DIR/CVS ]]; then
        if hash cvs &>/dev/null; then
            (cd "$DIR" && cvs rlog . 2>/dev/null) |
            grep -c '^revision '
        fi
    fi
}

REV=$(cvs_rev "${1:-$PWD}")
if [[ -n $REV && $((REV+0)) -gt 0 ]]; then
    echo "$DOCDIR_BASE/$(basename -- "${1:-$PWD}")-r$REV"
else
    exec "$(dirname -- "$(readlink -f -- "$0")")/bzr-docdir" "$@"
fi
